ui_print("- Flashing DarkLord Kernel");
set_progress(0.10);
run_program("/sbin/busybox", "mount", "/dev/block/platform/msm_sdcc.1/by-name/system", "/system");
run_program("/sbin/busybox", "mount", "/data");
run_program("/sbin/busybox", "mount", "/cache");
run_program("/sbin/busybox", "mount", "/preload");
package_extract_file("boot.img", "/dev/block/platform/msm_sdcc.1/by-name/boot");
set_progress(0.30);
delete_recursive("/system/lib/modules");
set_progress(0.40);
package_extract_dir("system", "/system");
set_progress(0.50);
delete("/system/tima_measurement_info");
#Remove Knox
delete("/system/app/STweaks.apk");
delete_recursive("/system/app/Bridge");
delete_recursive("/system/app/KnoxAttestationAgent");
delete_recursive("/system/app/KnoxMigrationAgent");
delete_recursive("/system/app/KnoxSetupWizardClient");
delete_recursive("/system/app/KnoxSetupWizardStub");
delete_recursive("/system/app/KNOXStore");
delete_recursive("/system/app/PreloadInstaller");
delete_recursive("/system/app/RCPComponents");
delete_recursive("/system/app/SecurityLogAgent");
delete_recursive("/system/app/UniversalMDMClient");
delete_recursive("/system/app/ELMAgent");
delete_recursive("/system/priv-app/SPDClient");
delete_recursive("/system/priv-app/KLMSAgent");
delete_recursive("/system/container");
delete_recursive("/system/preloadedsso");
delete_recursive("/system/etc/secure_storage/com.samsung.android.securitylogagent");
delete_recursive("/system/etc/secure_storage/com.sec.knox.store");
delete_recursive("/data/knox");
delete_recursive("/data/container");
delete_recursive("/data/.container_1");
delete_recursive("/data/.container_2");
delete_recursive("/data/.container_3");
delete_recursive("/system/lib/modules");
delete_recursive("/system/bin/containersetup");
delete_recursive("/system/bin/tima_dump_log");
delete_recursive("/system/bin/auditd");
set_progress(0.70);
set_progress(0.90);
unmount("/system");
unmount("/data");
unmount("/cache");
unmount("/preload");
ui_print(" ");
set_progress(1);
ui_print("- Done, please reboot");
